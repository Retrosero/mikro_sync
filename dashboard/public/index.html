<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Gürbüz Oyuncak Senkronizasyon Sistemi</title>
    <link rel="icon" type="image/png" href="/icon.png" />
    <link rel="apple-touch-icon" href="/icon.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#f8fafc" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&amp;display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700&amp;display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "border-light": "#f1f5f9",
                        "status-success": "#10b981",
                        "status-error": "#ef4444",
                        "status-warning": "#f59e0b",
                    },
                    fontFamily: {
                        "sans": ["Inter", "sans-serif"],
                        "mono": ["JetBrains Mono", "ui-monospace", "SFMono-Regular", "Menlo", "Monaco", "Consolas", "monospace"]
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                        'hover': '0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05)',
                    }
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        @layer base {
            body {
                @apply bg-slate-50 text-slate-800 antialiased;
            }
        }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 24;
            display: inline-block;
            vertical-align: middle;
        }
        .log-container::-webkit-scrollbar {
            width: 6px;
        }
        .log-container::-webkit-scrollbar-track {
            background: transparent;
        }
        .log-container::-webkit-scrollbar-thumb {
            background: #e2e8f0;
            border-radius: 10px;
        }
        
        /* Reference Style Card */
        .cmd-card {
            @apply bg-white border border-slate-100 p-4 rounded-3xl shadow-soft hover:shadow-hover transition-all duration-500 flex flex-col items-center text-center relative overflow-hidden;
        }
        
        .icon-box {
            @apply mb-3 p-2.5 bg-blue-50 text-primary rounded-xl group-hover:bg-primary group-hover:text-white transition-all duration-300;
        }

        /* Running Animation */
        .btn-running {
            @apply bg-primary/10 text-primary border-primary/20 animate-pulse;
        }
    </style>
</head>

<div class="h-screen flex flex-col overflow-hidden">
    <!-- Minimal Header -->
    <header class="p-6 border-b border-slate-100 flex items-center justify-between shrink-0 bg-white shadow-sm z-10">
        <div class="flex items-center gap-4">
            <div class="p-1 bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                <img src="/icon.png" alt="Logo" class="size-9 object-contain" />
            </div>
            <div>
                <h1 class="text-xl font-extrabold tracking-tight text-slate-900 leading-none">
                    Gürbüz Oyuncak <span class="text-primary text-sm uppercase tracking-tighter ml-1">Sync</span>
                </h1>
                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-[0.2em] mt-1">Şirket Bilgisi</p>
            </div>
        </div>
        <div class="flex items-center gap-6">
            <button id="camera-btn"
                class="p-2 bg-slate-100 text-slate-600 rounded-lg hover:bg-primary hover:text-white transition-all shadow-sm group">
                <span class="material-symbols-outlined group-hover:scale-110 transition-transform">photo_camera</span>
            </button>
            <div id="status-text"
                class="px-3 py-1 bg-slate-100 text-slate-600 text-[9px] font-bold tracking-widest uppercase rounded-full">
                Yükleniyor</div>
            <div class="flex items-center gap-3 pr-2">
                <span id="system-status-dot" class="size-2 bg-slate-300 rounded-full"></span>
                <span id="system-status-text"
                    class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Bağlanıyor</span>
            </div>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden">
        <!-- Left Side: Custom Menu (50% Width) -->
        <section class="w-[50%] border-r border-slate-100 overflow-y-auto p-6 bg-slate-50/30">
            <div id="dashboard-menu-container" class="grid grid-cols-2 gap-6 pb-8">
                <!-- Categories will be injected here -->
            </div>
        </section>

        <!-- Right Side: Full Logs (Remaining Width) -->
        <section class="flex-1 flex flex-col bg-white overflow-hidden shadow-2xl relative">
            <div class="flex items-center justify-between px-8 py-5 border-b border-slate-100 shrink-0 bg-slate-50/50">
                <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-primary text-xl">article</span>
                    <h2 class="text-[11px] font-black text-slate-500 uppercase tracking-[0.3em]">Canlı Sistem Günlüğü
                    </h2>
                </div>
                <div class="flex items-center gap-4">
                    <button id="view-failed-items"
                        class="group flex items-center gap-2 px-3 py-1.5 bg-orange-50 text-orange-600 rounded-lg hover:bg-orange-100 transition-all text-[9px] font-black tracking-widest uppercase"
                        title="Hatalı Kayıtları Gör">
                        <span class="material-symbols-outlined text-sm">assignment_late</span>
                        Hatalı Kayıtlar
                    </button>
                    <button id="view-errors"
                        class="group flex items-center gap-2 px-3 py-1.5 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-all text-[9px] font-black tracking-widest uppercase"
                        title="Hata Kayıtlarını Gör">
                        <span class="material-symbols-outlined text-sm">error</span>
                        Hata Logları
                    </button>
                    <button id="clear-logs"
                        class="group p-2 hover:bg-red-50 text-slate-300 hover:text-red-500 rounded-lg transition-all"
                        title="Veri Akışını Temizle">
                        <span
                            class="material-symbols-outlined text-xl transition-transform group-hover:scale-110">delete</span>
                    </button>
                </div>
            </div>

            <!-- Failed Items Modal -->
            <div id="failed-items-modal"
                class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4 hidden animate-in fade-in duration-300">
                <div
                    class="bg-white w-full max-w-6xl max-h-[85vh] rounded-[2.5rem] shadow-2xl flex flex-col overflow-hidden animate-in zoom-in-95 duration-300 border border-slate-100">
                    <div class="p-8 border-b border-slate-100 flex items-center justify-between shrink-0 bg-white">
                        <div class="flex items-center gap-4">
                            <div class="p-4 bg-orange-50 text-orange-500 rounded-2xl shadow-sm">
                                <span class="material-symbols-outlined text-2xl">sync_problem</span>
                            </div>
                            <div>
                                <h3 class="text-xl font-black text-slate-900 tracking-tight">Hatalı Senkronizasyon
                                    Kayıtları</h3>
                                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-1">ERP'ye
                                    Aktarılamayan Sipariş ve İşlemler</p>
                            </div>
                        </div>
                        <button id="close-failed-modal"
                            class="p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-400">
                            <span class="material-symbols-outlined">close</span>
                        </button>
                    </div>
                    <div class="flex-1 overflow-auto p-4 bg-slate-50/10">
                        <div class="bg-white rounded-3xl border border-slate-100 shadow-sm overflow-hidden">
                            <table class="w-full text-left border-collapse">
                                <thead>
                                    <tr
                                        class="bg-slate-50 text-[9px] font-black text-slate-400 uppercase tracking-widest border-b border-slate-100">
                                        <th class="px-6 py-4">Servis / ID</th>
                                        <th class="px-6 py-4">İşlem</th>
                                        <th class="px-6 py-4">Hata Detayı</th>
                                        <th class="px-6 py-4">Son İşlem</th>
                                        <th class="px-6 py-4 text-right">İşlemler</th>
                                    </tr>
                                </thead>
                                <tbody id="failed-items-tbody"
                                    class="divide-y divide-slate-50 font-medium text-[11px] text-slate-600">
                                    <!-- Dynamic content -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Error Modal -->
            <div id="error-modal"
                class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4 hidden animate-in fade-in duration-300">
                <div
                    class="bg-white w-full max-w-4xl max-h-[85vh] rounded-[2.5rem] shadow-2xl flex flex-col overflow-hidden animate-in zoom-in-95 duration-300 border border-slate-100">
                    <div class="p-8 border-b border-slate-100 flex items-center justify-between shrink-0 bg-white">
                        <div class="flex items-center gap-4">
                            <div class="p-4 bg-red-50 text-red-500 rounded-2xl shadow-sm">
                                <span class="material-symbols-outlined text-2xl">warning</span>
                            </div>
                            <div>
                                <h3 class="text-xl font-black text-slate-900 tracking-tight">Detaylı Hata Kayıtları</h3>
                                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-1">
                                    Sistemdeki Tüm Kritik Hatalar (errors.log)</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <button id="clear-error-file"
                                class="px-4 py-2 bg-slate-50 text-red-600 rounded-xl text-[10px] font-black hover:bg-red-500 hover:text-white transition-all tracking-wider uppercase">LOGLARI
                                TEMİZLE</button>
                            <button id="close-modal"
                                class="p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-400">
                                <span class="material-symbols-outlined">close</span>
                            </button>
                        </div>
                    </div>
                    <div id="error-log-content"
                        class="flex-1 overflow-y-auto p-10 font-mono text-[11px] leading-relaxed bg-slate-50 text-slate-700 whitespace-pre-wrap">
                        <div class="flex flex-col items-center justify-center h-full text-slate-300">
                            <span class="material-symbols-outlined text-6xl mb-4 animate-pulse">hourglass_empty</span>
                            <p class="font-bold tracking-widest uppercase text-xs">Veriler Yükleniyor...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Table Header -->
            <div
                class="grid grid-cols-[90px_110px_80px_1fr] px-8 py-3 bg-slate-100/30 text-[9px] font-black text-slate-400 tracking-widest uppercase shrink-0 border-b border-slate-50">
                <div>Zaman</div>
                <div>Servis</div>
                <div>Statü</div>
                <div>Mesaj Detayı</div>
            </div>

            <!-- Scrollable Logs Content -->
            <div id="log-container" class="log-container flex-1 overflow-y-auto font-mono text-[12px] bg-slate-50/10">
                <!-- Logs will be injected here -->
            </div>

            <footer class="px-8 py-4 border-t border-slate-50 text-right shrink-0 bg-white">
                <p class="text-slate-300 text-[10px] font-bold tracking-widest uppercase italic">Gerçek Zamanlı Veri
                    Akışı Aktif</p>
            </footer>
        </section>
    </main>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="script.js"></script>
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js').then(registration => {
                console.log('SW registered: ', registration);
            }).catch(registrationError => {
                console.log('SW registration failed: ', registrationError);
            });
        });
    }
</script>
</body>

</html>